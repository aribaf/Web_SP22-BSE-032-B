"use strict";async function r(f){/in/.test(document.readyState)?setTimeout("r("+f+")",9):f()}r(async function(){let o="https://production.api.harperconcierge.com",t,i,n,r,a,s=!0,l=!0;const d=async function(){document.getElementById("harper-concierge-slider").classList.toggle("harper-content"),document.getElementById("harper-concierge-slider").classList.toggle("closed"),document.getElementById("harper").classList.toggle("closed"),document.getElementById("close-button").classList.toggle("hidden"),document.getElementById("london-message").classList.toggle("harper-cwh-hidden"),document.getElementById("harper").classList.toggle("border-popup"),!1===i.enable_icon_question&&document.getElementById("icon__question").classList.add("hidden")},p=async function(){document.getElementById("harper-confirm-popup").style.display="none"},m=function(){const e=[];Array.from(document.getElementsByClassName("modal-mask")).forEach(function(element){e.push(element)}),Array.from(document.getElementsByClassName("popup-message")).forEach(function(element){e.push(element)}),Array.from(e).forEach(function(el){el.classList.toggle("active")})},c=function(){const e=[];Array.from(document.getElementsByClassName("modal-mask")).forEach(function(element){e.push(element)}),Array.from(document.getElementsByClassName("popup-message")).forEach(function(element){e.push(element)}),Array.from(e).forEach(function(el){el.classList.remove("active")})};const u=async function(){return(await fetch("/cart.js")).json()},h=async function(info_to_be_sent){var e=o+"/api/public/create-checkout",t={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(info_to_be_sent)};try{var n=await fetch(e,t),r=await n.json();return r.http_code=n.status,r}catch(a){return a}},g=async function(){var e;(n=await u()).postcode=document.querySelector('input[name="postcode"]').value,t=!1,(document.getElementById("harper-error").innerHTML="")!==n.postcode||t?(e={postcode:n.postcode,partner_pid:i.partner_pid,platform_data:{partner_cart:n}},e=await h(e),await y(e)):(document.getElementById("harper-error").innerHTML="Your postcode cannot be empty",t=!0)},y=async function(result){if(200===result.http_code){v(["harper-error"]);var c=a+result.data.cart_pid+"&p="+i.partner_reference,e=document.createElement("a"),c=(e.href=c,e.style.display="none",document.body.appendChild(e),new MouseEvent("mousedown",{view:window,bubbles:!0,cancelable:!0}));e.dispatchEvent(c),e.click(),document.body.removeChild(e),await p()}else if(422===result.http_code){if(result.data&&result.data?.items){c=result.data["items"];let t,n,r,a=[],o=[],s=[],d=[];if(c.items_to_block&&0<c.items_to_block.length){t=i.popup2_step_1_message,n=i.popup2_step_2_message,a=c.items_pre_order,o=c.items_to_block,s=c.items_available,d=c.items_partially_blocked,document.getElementById("harper-error-message1").innerHTML=t,"shrimps"===i.partner_reference&&(document.getElementById("harper-preorder-modal").classList.add("font-configuration"),document.getElementById("harper-preorder-modal").classList.remove("modal-container"));for(let e=0;e<o.length;e++)document.getElementById("harper-blocked-item").innerHTML+=o[e].original_name+"<br />";if(0<d.length)for(let e=0;e<d.length;e++)document.getElementById("harper-blocked-item").innerHTML+=d[e].original_name+"<br />";if(0<a.length)for(let e=0;e<a.length;e++)document.getElementById("harper-blocked-item").innerHTML+=a[e].original_name+"<br />";r=0<d.length&&0<s.length?s.concat(d):s,l=!1===result.data.items.can_proceed||!0===result.data.items.can_proceed&&!0===i.completely_block_sale_item?(document.getElementById("harper-preorder-button").innerHTML="CHECKOUT",document.getElementById("harper-order-brand").classList.add("place-order-hide"),document.getElementById("harper-order-brand").classList.remove("place-order"),document.getElementById("harper-error-message2").classList.add("harper-message2-hide"),document.getElementById("harper-error-message2").classList.remove("harper-message2"),!1):(document.getElementById("harper-preorder-button").innerHTML="PROCEED ANYWAY",document.getElementById("harper-order-brand").innerHTML="Place full order with "+i.partner_name,document.getElementById("harper-order-brand").classList.add("place-order"),document.getElementById("harper-order-brand").classList.remove("place-order-hide"),document.getElementById("harper-error-message2").innerHTML=n,document.getElementById("harper-error-message2").classList.remove("harper-message2-hide"),document.getElementById("harper-error-message2").classList.add("harper-message2"),!0)}else{t=i.popup_step_1_message,n=i.popup_step_2_message,a=c.items_pre_order,o=c.items_to_block,s=c.items_available,d=c.items_partially_blocked,document.getElementById("harper-error-message1").innerHTML=t,"shrimps"===i.partner_reference&&(document.getElementById("harper-preorder-modal").classList.add("font-configuration"),document.getElementById("harper-preorder-modal").classList.remove("modal-container"));for(let e=0;e<a.length;e++)document.getElementById("harper-preorder-item").innerHTML+=a[e].original_name+"<br />";if(0<a.length&&0<d.length&&0==s.length||0<d.length&&0==s.length&&0==a.length)for(let e=0;e<d.length;e++)document.getElementById("harper-blocked-item").innerHTML+=d[e].original_name+"<br />";r=0<d.length&&0<s.length?s.concat(d):s,l=!1===result.data.items.can_proceed?(document.getElementById("harper-preorder-button").innerHTML="CHECKOUT",document.getElementById("harper-order-brand").classList.add("place-order-hide"),document.getElementById("harper-order-brand").classList.remove("place-order"),document.getElementById("harper-error-message2").classList.add("harper-message2-hide"),document.getElementById("harper-error-message2").classList.remove("harper-message2"),!1):(document.getElementById("harper-preorder-button").innerHTML="PROCEED ANYWAY",document.getElementById("harper-order-brand").innerHTML="Place full order with "+i.partner_name,document.getElementById("harper-order-brand").classList.add("place-order"),document.getElementById("harper-order-brand").classList.remove("place-order-hide"),document.getElementById("harper-error-message2").innerHTML=n,document.getElementById("harper-error-message2").classList.remove("harper-message2-hide"),document.getElementById("harper-error-message2").classList.add("harper-message2"),!0)}m()}result?.messages&&(v(["harper-success"]),_("harper-error",result.messages[0].message),document.getElementById("harper-error").innerHTML=result.messages[0].message,t=!0)}document.body.classList.add("harper-inserted")},v=function(elementIds){elementIds.forEach(elementId=>{var e=document.getElementById(elementId);e&&(e.classList.add("hidden"),e.innerHTML="")})},_=function(elementId,content=""){var e=document.getElementById(elementId);e&&(e.classList.remove("hidden"),e.innerHTML=content)},f=(await!((B=document.getElementById("harper-identification"))&&(r=B.className,B=await fetch("https://s3-eu-west-1.amazonaws.com/harper.assets/"+r+".json?v=1"),i=await B.json())),await u(),await!(a=i.env?(o=i.env.api_url,i.env.checkout_url):(o="https://production.api.harperconcierge.com","https://checkout.harperconcierge.com/?c=")),'<div>\n    <h3 id="harper_try_at_home_button" class="try-at-home-btn" class="header">\n'+i.try_at_home_btn_text+'</h3>\n</div>\n<div id="london-message" class="harper-bottom-message">\n    <p>'+i.message_under_try_at_home_btn+'</p>\n</div>\n\n<div id="harper-checkout-wrapper" class="harper-wrapper">\n    <div class="vl-popup closed" id="harper">\n        <div id="close-button" class="vl-close-button hidden">\n            <svg style="height: 15px; width: 15px;" class="Icon Icon--close" role="presentation" viewBox="0 0 16 14">\n                <path d="M15 0L1 14m14 0L1 0" stroke="currentColor" fill="none" fill-rule="evenodd"></path>\n            </svg>\n        </div>\n        <div id="harper-concierge-slider" class="closed clearfix">\n            <div class="vl-popup-title">\n                <h2 class="popup-title">'+i.postcode_checker_title+"</h2>\n"+i.cwh_content+'            </div>\n            <div class="vl-send-basket-form">\n                <div id="harper-error" class="vl-error-message"></div>\n                <div id="harper-success" class="vl-success-message hidden"></div>\n                <form name="harper-send-to-parent-form" id="harper-send-to-parent-form" class="vl-form-container">\n                    <input id="harper-cart-data" type="hidden" name="harper-cartdata" value=""/>\n                    <input type="hidden" name="harper-retailer" value="1011">\n                    <div class="vl-input-holder">\n                        <input\n                                type="text"\n                                class="form-control"\n                                id="postcode"\n                                name="postcode"\n                                placeholder="'+i.post_code_placeholder+'"\n                                value=""/>\n                    </div>\n                    <div class="vl-input-holder">\n                        <button id="harper_continue_button" type="button">'+i.postcode_checker_btn_text+'</button>\n                    </div>\n                </form>\n            </div>\n        </div>\n                <div id="icon__question" class="message_postcode">\n <p>'+i.message_under_postcode_checker+'                <svg class="open-harper-modal" width="13" height="13" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">\n                  <circle cx="9" cy="9" r="8.5" stroke="#1D1D1B"></circle>\n                  <path d="M5.625 6.36986H7.34576C7.40434 5.47653 8.0121 4.90538 8.95669 4.90538C9.87931 4.90538 10.4944 5.45456 10.4944 6.21609C10.4944 6.941 10.1868 7.32909 9.27887 7.87827C8.26838 8.47138 7.84368 9.1304 7.90958 10.2288L7.91691 10.7267H9.6157V10.3093C9.6157 9.58438 9.88663 9.21094 10.8459 8.64712C11.8417 8.05401 12.3982 7.27051 12.3982 6.15018C12.3982 4.53194 11.0582 3.375 9.05188 3.375C6.87713 3.375 5.68358 4.63445 5.625 6.36986ZM8.84685 14.2195C9.59373 14.2195 10.0624 13.7581 10.0624 13.0552C10.0624 12.3449 9.59373 11.8836 8.84685 11.8836C8.11461 11.8836 7.63133 12.3449 7.63133 13.0552C7.63133 13.7581 8.11461 14.2195 8.84685 14.2195Z" fill="#1D1D1B"></path>\n               </svg>\n </p>\n             </div>\n    </div>\n</div>'),E='<div id="checkout-with-harper-modal" class="popup-overlay harper-popup-wrapper n-animate">\n    <div class="popup-content harper-popup-inner">\n\n\n        <div class="popup-content n-animate">\n\n\n\n\n            <button class="close-harper-modal"></button>\n            <div class="top-section">\n                <div class="top-section-left">\n\n\n                    <h2>'+i.popup_title+'</h2>\n\n                    <p class="harper-white">'+i.popup_content+' </b></p>\n\n\n                    <div class="mob-only">\n                        <p class="bold">'+i.popup_bottom_message+'</p>\n\n                        <a href="#harp-pop-sect-2" class="scroll-link">Scroll</a>\n                    </div>\n\n                </div>\n\n\n                <div class="top-section-right desk-only" style="'+(i.image_url?`background: url(${i.image_url}) no-repeat center center / cover;`:"")+'">\n                </div>\n\n            </div>\n\n\n\n\n\n            <div class="bottom-section" id="harp-pop-sect-2">\n\n                <button class="close-harper-modal mob-only"></button>\n\n                <h3 class="mob-only">How it works</h3>\n\n                <div class="num-section">\n                    <div class="num-row">\n                        <div class="num-num">1.</div>\n\n                        <div class="num-copy">\n                            <h5>'+i.popup_step_1_title+"</h5>\n                            "+i.popup_step_1_content+'                        </div>\n                    </div>\n\n                    <div class="num-row">\n                        <div class="num-num">2.</div>\n\n\n                        <div class="num-copy">\n                            <h5>'+i.popup_step_2_title+"</h5>\n                            "+i.popup_step_2_content+'                        </div>\n                    </div>\n\n                    <div class="num-row last">\n                        <div class="num-num">3.</div>\n\n                        <div class="num-copy"><h5>'+i.popup_step_3_title+"</h5>\n                            "+i.popup_step_3_content+'                        </div>\n                    </div>\n\n                </div>\n\n                <p class="bold desk-only">'+i.popup_bottom_message+'</p>\n\n                <div class="faq-link"><a href="'+i.faq_link+'" target="_blank">'+(i.faq_text||"Visit our FAQ page")+"</a></div>\n\n            </div>\n        </div>\n    </div>\n</div>",b='<div id="harper-concierge-preorder" class="popup-message" >\n<div id="harper-modal-mask" class="modal-mask">\n<div id="harper-preorder-modal" class="modal-container">\n<div class="preorder-heading">\n<h3 class= "preOrder_title">Try Before You Buy</h3>\n</div>\n<div id="harper-preorder-item" class="harper-item-list"></div>\n<div id="harper-blocked-item" class="harper-item-list"></div>\n<div id= "harper-error-message1" class="harper-message1"></div>\n<div id= "harper-error-message2" class="harper-message2"></div>\n<div>\n<h3 id="harper-preorder-button" class="proceed-btn"></h3>\n</div>\n<div id= "harper-order-brand" class="place-order"></div>\n</div>\n</div>';var B=document.createElement("link");B.href="https://s3-eu-west-1.amazonaws.com/harper.assets/harper-styles.css",B.rel="stylesheet",document.head.appendChild(B);const L=function(){const e=[];var t=document.getElementById("harper-modal-override");if(t)return t.style.display="block",t.style.visibility="visible",t.style.opacity=1,(t=t.getElementsByTagName("div")[0])&&(t.style.display="block",t.style.visibility="visible",t.style.opacity=1),!0;Array.from(document.getElementsByClassName("popup-content")).forEach(function(element){e.push(element)}),Array.from(document.getElementsByClassName("popup-overlay")).forEach(function(element){e.push(element)}),Array.from(e).forEach(function(el){el.classList.toggle("active")})},I=function(){const e=[];var t=document.getElementById("harper-modal-override");if(t)return t.style.display="none",t.style.visibility="hidden",t.style.opacity=0,(t=t.getElementsByTagName("div")[0])&&(t.style.display="none",t.style.visibility="hidden",t.style.opacity=0),!0;Array.from(document.getElementsByClassName("popup-content")).forEach(function(element){e.push(element)}),Array.from(document.getElementsByClassName("popup-overlay")).forEach(function(element){e.push(element)}),Array.from(e).forEach(function(el){el.classList.remove("active")})},w=(document.addEventListener("click",function(e){var t;e.target&&"harper_try_at_home_button"===e.target.id?d():e.target&&"harper_continue_button"===e.target.id?g():e.target&&"harper-preorder-button"===e.target.id?(document.getElementById("harper_continue_button").classList.add("hidden"),async function(){var e;await c(),!1===l?(e=window.location.origin+"/checkout",window.location.href=e):(e={postcode:n.postcode,partner_pid:i.partner_pid,platform_data:{partner_cart:n},customer_aware_of_blocked_items:!0},e=await h(e),await y(e))}()):e.target&&"harper-order-brand"===e.target.id?(t=window.location.origin+"/checkout",window.location.href=t):e.target&&"harper-modal-mask"===e.target.id&&(document.getElementById("harper-preorder-item").innerHTML="",document.getElementById("harper-blocked-item").innerHTML="",c())}),document.addEventListener("keypress",function(e){e.target&&"postcode"===e.target.id&&13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),g())}),function(){const e=[],t=(Array.from(document.getElementsByClassName("open-harper-modal")).forEach(function(el){e.push(el)}),Array.from(e).forEach(function(element){element.addEventListener("click",L)}),Array.from(document.getElementsByClassName("Icon--close")).forEach(function(el){el.addEventListener("click",d)}),[]);Array.from(document.getElementsByClassName("close-harper-modal")).forEach(function(el){t.push(el)}),Array.from(document.getElementsByClassName("harper-popup-wrapper")).forEach(function(el){t.push(el)}),Array.from(t).forEach(function(element){element.addEventListener("click",I)})}),k=function(){var e,t=document.getElementById("checkout-harper"),n=document.getElementById("mole");t&&!n&&(t=document.getElementById("checkout-harper"))&&(!0===s&&(n=document.createElement("div"),e=document.createElement("div"),n.innerHTML=E,e.innerHTML=b,document.body.appendChild(n),document.body.appendChild(e)),t.insertAdjacentHTML("afterend",f),t.insertAdjacentHTML("afterend",'<div id="mole"></div>'),w(),c(),document.body.classList.add("harper-inserted"),s=!1),setTimeout(k,10)};k()});