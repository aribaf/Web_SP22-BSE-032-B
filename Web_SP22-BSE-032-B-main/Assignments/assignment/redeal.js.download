(()=>{const e={IDENTIFIED:"redeal-idfd",HASLOGGEDIN:"redeal-hlgn",DEBUG:"redeal-debug",MINCLOSE:"redeal-mc-",DEAL_ID:"redeal-deal-id",DISABLEALLDEAL:"redeal-disalldeal",TAG_DEAL:"redeal-dealid-",AMB_CV:"redeal-amb-cv",FRI_CV:"redeal-frnd-cv",LFVD:"redeal-lfvd",FRI_CONV_DEAL:"redeal-frnd-deal",CPODATA:"",SESSIONSTORAGE:"SS",LOCALSTORAGE:"LS",AMB_FINISH:"redeal-amb-finish",NEXT_DEALTRIGGER:"redeal_trigger_nd",NEXT_DEALTRIGGERFLOW:"redeal_trigger_nd_pflow",SELECTED_SITE:"redeal-selectsite",SELECTED_DOMAIN:"redeal-sel-domain",SELECTED_PARAM:"redeal-sel-param",LAST_VISITDEAL:"redeal-lvd",AMB_AUDIENCE:"redeal-amb-aud",AMB_SUBSCRIBE:"redeal-amb-sub",REF:"redeal-ref",SCRIPTVERSION:"103",FRIEND_CONV_ID:"redeal-conv-friend-ids",PAGESHARE:"redeal-ps",INITITALSESSIONURL:"voyado-initurl",TRIGGERONCEPERSESSION:"redeal-tops",VOYADOCONTACTID:"voyado-cid"};function t(e){return c?null:localStorage.getItem(e)}function r(t,r){c||(localStorage.setItem(t,r),N(e.LOCALSTORAGE,"set",t,r))}function n(t){c||(localStorage.removeItem(t),N(e.LOCALSTORAGE,"remove",t))}function o(e){return c?null:sessionStorage.getItem(e)}function l(t,r){c||(sessionStorage.setItem(t,r),N(e.SESSIONSTORAGE,"set",t,r))}function a(t){c||(sessionStorage.removeItem(t),N(e.SESSIONSTORAGE,"remove",t))}window.DEFAULT_APIPATH="https://api.onsite.voyado.com",window.DEFAULT_FILEPATH="https://static.onsite.voyado.com";const i="/api/widgetflowevent",d="/api/conversion";var s=window.location.href.toLowerCase();let c=!1,u=!1,f=!1,E="",p="",g="Unknown",I=(new Date).getTime(),S=new URL(window.location.href).hostname.replace("www",""),A=t("redeal-id"),w=(new Date).getTime().toString(16)+Math.floor(1e7*Math.random()).toString(16);window.IS_DEBUG=s.indexOf("redeal-debug")>-1||s.indexOf("voyado-debug")>-1||null!=t(e.DEBUG)&&1==t(e.DEBUG);let b=!1;window.getBrowserDetails=function(){const e=v.includes("mobile"),t=/(ipad|tablet|android(?!.*mobile))/.test(v),r={Instagram:"Instagram",FBAN:"Facebook",Snapchat:"Snapchat",electron:"Electron",NAVER:"Naver",Whale:"Whale",XiaoMi:"XiaoMi",FBAV:"Facebook",SamsungBrowser:"Samsung",YaBrowser:"Yandex",UBrowser:"UCBrowser",Opera:"Opera",OPR:"Opera",Edge:"Edge",Chrome:"Chrome",CriOS:"Chrome",Safari:"Safari",Firefox:"Firefox",MSIE:"IE",documentMode:"IE"};let n="Unknown";for(const e in r)if(v.includes(e.toLowerCase())){n=r[e];break}return{deviceType:t?"Tablet":e?"Mobile":"Desktop",os:Object.entries({Win:"Windows",Mac:"MacOS",Android:"Android",Linux:"Linux","like Mac":"iOS"}).find((([e])=>v.includes(e)))?.[1]||"Unknown",browserType:n,language:navigator.language||navigator.userLanguage}},window.RedealSetIdentified=()=>{null==t(e.IDENTIFIED)&&1==b&&r(e.IDENTIFIED,"1")};var O=window.screen.width+"x"+window.screen.height,v=navigator.userAgent.toLowerCase(),m=new RegExp("(googlebot/|bot|Googlebot-Mobile|Googlebot-Image|Google favicon|Mediapartners-Google|bingbot|slurp|java|wget|curl|Commons-HttpClient|Python-urllib|libwww|httpunit|nutch|phpcrawl|msnbot|jyxobot|FAST-WebCrawler|FAST Enterprise Crawler|biglotron|teoma|convera|seekbot|gigablast|exabot|ngbot|ia_archiver|GingerCrawler|webmon |httrack|webcrawler|grub.org|UsineNouvelleCrawler|antibot|netresearchserver|speedy|fluffy|bibnum.bnf|findlink|msrbot|panscient|yacybot|AISearchBot|IOI|ips-agent|tagoobot|MJ12bot|dotbot|woriobot|yanga|buzzbot|mlbot|yandexbot|purebot|Linguee Bot|Voyager|CyberPatrol|voilabot|baiduspider|citeseerxbot|spbot|twengabot|postrank|turnitinbot|scribdbot|page2rss|sitebot|linkdex|Adidxbot|blekkobot|ezooms|dotbot|Mail.RU_Bot|discobot|heritrix|findthatfile|europarchive.org|NerdByNature.Bot|sistrix crawler|ahrefsbot|Aboundex|domaincrawler|wbsearchbot|summify|ccbot|edisterbot|seznambot|ec2linkfinder|gslfbot|aihitbot|intelium_bot|facebookexternalhit|yeti|RetrevoPageAnalyzer|lb-spider|sogou|lssbot|careerbot|wotbox|wocbot|ichiro|DuckDuckBot|lssrocketcrawler|drupact|webcompanycrawler|acoonbot|openindexspider|gnam gnam spider|web-archive-net.com.bot|backlinkcrawler|coccoc|integromedb|content crawler spider|toplistbot|seokicks-robot|it2media-domain-crawler|ip-web-crawler.com|siteexplorer.info|elisabot|proximic|changedetection|blexbot|arabot|WeSEE:Search|niki-bot|CrystalSemanticsBot|rogerbot|360Spider|psbot|InterfaxScanBot|Lipperhey SEO Service|CC Metadata Scaper|g00g1e.net|GrapeshotCrawler|urlappendbot|brainobot|fr-crawler|binlar|SimpleCrawler|Livelapbot|Twitterbot|cXensebot|smtbot|bnf.fr_bot|A6-Indexer|ADmantX|Facebot|Twitterbot|OrangeBot|memorybot|AdvBot|MegaIndex|SemanticScholarBot|ltx71|nerdybot|xovibot|BUbiNG|Qwantify|archive.org_bot|Applebot|TweetmemeBot|crawler4j|findxbot|SemrushBot|yoozBot|lipperhey|y!j-asr|Domain Re-Animator Bot|AddThis)","i"),h=window.location.host;window.redealJsLoaded=[],window.redeal_hidetriggered=!1;var D=s.indexOf("redeal-mode=preview")>-1&&s.indexOf("campaignid=")>-1;function L(){return s.indexOf("eclub")>-1&&s.indexOf("vtid")>-1||!!("function"==typeof redeal||D||s.indexOf("redeal_referer=redeal")>-1||s.indexOf("referer=redeal")>-1||s.indexOf("redeal-type=")>-1||s.indexOf("voyado_referer=voyado")>-1||s.indexOf("referer=voyado")>-1||s.indexOf("voyado-type=")>-1)}function T(e,t){var r=t||s,n=new RegExp("[?&]"+e+"=([^&#]*)","i").exec(r);return n?n[1].toLowerCase():null}function y(t,r){IS_DEBUG&&console.log("redeal2",t,r),void 0===t?redealInit("instant"):null!=t&&(C(t)?(redealInit("instant"),e.CPODATA=_(JSON.stringify(t))):(void 0!==r&&C(r)&&(e.CPODATA=_(JSON.stringify(r))),redealInit(t)))}function C(e){e="string"!=typeof e?JSON.stringify(e):e;try{e=JSON.parse(e)}catch(e){return!1}return"object"==typeof e&&null!==e}function _(e){var t,r,n=e,o="",l=new Array,a=new Array,i=new Array;if(""!==n&&0!==n.length&&null!=n){for(var d=0;d<n.length;d++)l[d]=n[d].charCodeAt(0);for(var s=0,c=65;s<26;s++,c++)a[s]=String.fromCharCode(c);for(var u=(t=0,r=a.length-1,Math.floor(Math.random()*(r-t+1)+t)),f=a[u].charCodeAt(0),E=0;E<n.length;E++)i[E]=parseInt(l[E],10)+parseInt(a[u].charCodeAt(0),10);i[l.length]=f;for(var p=0;p<i.length;p++)o+=String.fromCharCode(i[p])}return o}function R(e){var t="",r=e;if(null!==r&&""!==r&&null!=r&&r.length>0){for(var n=r,o=n[n.length-1],l=new Array,a=0;a<n.length-1;a++)l[a]=n[a].charCodeAt(0)-o.charCodeAt(0);for(a=0;a<l.length;a++)t+=String.fromCharCode(l[a])}return t}function N(e,t,r,n){IS_DEBUG&&(null==n&&(n=""),console.log(e+" "+h+" "+t+" "+r,n))}function T(e,t){var r=t||s,n=new RegExp("[?&]"+e+"=([^&#]*)","i").exec(r);return n?n[1]:null}window.redealLogin=()=>{null==t(e.HASLOGGEDIN)&&r(e.HASLOGGEDIN,"1"),b=!0,RedealSetIdentified()},window.redealInit=L=>{try{if(s.indexOf("file://")>-1||s.indexOf("localhost:")>-1)return;if(window.redeal_hidetriggered=!1,s.indexOf("redeal-hide")>-1)return;if(!IS_DEBUG||"all"!=L&&""!=L&&null!=L&&null!=L?IS_DEBUG&&console.log("redeal("+L+")"):console.log("redeal()"),m.test(v))return!1;try{localStorage}catch(e){c=!0}if(null!==o(e.DISABLEALLDEAL+":"+S)&&"1"===o(e.DISABLEALLDEAL+":"+S))return!1;if(IS_DEBUG&&console.log("redealinit",L),null!=o(e.INITITALSESSIONURL)&&null!=o(e.INITITALSESSIONURL)&&""!=o(e.INITITALSESSIONURL)||l(e.INITITALSESSIONURL,s),null==s||s.indexOf(".")<0){if(!(void 0!==document.location.href&&document.location.href.indexOf(".")>0)){var C="Failed to read domain from url.";return P(C,null,"error","script",IS_DEBUG),!1}s=document.location.href.toLowerCase()}if((s.indexOf("redeal-clear")>0||s.indexOf("voyado-clear")>0)&&(c||localStorage.clear(),c||sessionStorage.clear()),document.querySelectorAll('script[src$="redeal.js"]').length>1&&x)return!1;if(void 0!==window.redealJsLoaded&&!0===window.redealJsLoaded)return!1;IS_DEBUG&&r(e.DEBUG,1),A?N(e.LOCALSTORAGE,"set","redeal-id",A):(A=(new Date).getTime().toString(16)+Math.floor(1e7*Math.random()).toString(16),r("redeal-id",A));try{var x=!1,M=!0,F=window.RedealObject;if(void 0!==F){var k=window[F];if(void 0!==k.q&&"[object Array]"===Object.prototype.toString.call(k.q)){var U=k.q.pop();void 0!==U&&U.length>0&&(L=U[0]),null!=U&&(IS_DEBUG&&console.log("redealfunction",L),u=!0,f=!0,document.querySelectorAll('script[src$="redeal.js"]').length>1&&(x=!0),void 0!==U[1]&&null!==U[1]&&(e.CPODATA=_(JSON.stringify(U[1])),IS_DEBUG&&console.log("redealfunction",L,U[1])))}else void 0!==k&&"[object Function]"===Object.prototype.toString.call(k)&&"redeal"==F?(u=!0,x=!0,f=!0):void 0===k.q&&(M=!1)}window.redeal=y;var V="";if(null!=L&&""!=L&&null!=L&&(V=L.toLowerCase().toString()),function(t){var r=document.getElementById("redeal-modal-container"),n=void 0!==o(e.NEXT_DEALTRIGGER)&&""!==o(e.NEXT_DEALTRIGGER)&&"1"==o(e.NEXT_DEALTRIGGER);(n||void 0!==window.redealJsLoaded&&window.redealJsLoaded.length>0&&window.redealJsLoaded.indexOf(t)<0)&&a(e.DEAL_ID);var l=!1;null!=r&&"undefined"!=r&&void 0!==r&&null==o(e.DEAL_ID)&&null==o(e.DEAL_ID)&&(n||(l=!0),r.parentNode.removeChild(r));var d=document.getElementById("redeal-min-js");null!=d&&"undefined"!=d&&null!=d&&null==o(e.DEAL_ID)&&null==o(e.DEAL_ID)&&(n||(l=!0),d.parentNode.removeChild(d));document.getElementById("redeal-minimized-button")&&"undefined"!=r&&null!=r&&void 0!==r&&(n||(l=!0),r.parentNode.removeChild(r));if(l){var c=new XMLHttpRequest;c.open("POST",DEFAULT_APIPATH+i,!0);var u=JSON.stringify({domain:s,denyreason:"Duplicate widget detected",code:t});c.setRequestHeader("Content-Type","application/json"),c.send(u)}}(V),window.RedealInProgress===V)return void console.log("Redeal already loading for "+V);if(window.RedealInProgress=V,null!==o(e.MINCLOSE+V)&&o(e.MINCLOSE+V)==h)return console.log("Redeal already closed from minimized"),!1;if(null!==o(e.AMB_FINISH+V)&&1==o(e.AMB_FINISH+V))return console.log("Redeal already completed"),!1;if(!u&&(s.indexOf("campaignid=")>-1||s.indexOf("redeal-dealid=")>-1||s.indexOf("voyado-dealid=")>-1||s.indexOf("redeal-userid=")>-1||s.indexOf("redeal-type=")>-1||s.indexOf("voyado-type=")>-1||s.indexOf("userid=")>-1)&&(u=!0),D&&(f=!(s.indexOf("redeal-type=friendrecall")>=0||s.indexOf("redeal-type=ambassadorrecall")>=0||s.indexOf("voyado-type=friendrecall")>=0||s.indexOf("voyado-type=ambassadorrecall")>=0)),void 0!==window.redealJsLoaded&&window.redealJsLoaded.length>0&&window.redealJsLoaded.indexOf(V)>=0&&null==o(e.DEAL_ID)&&null==o(e.DEAL_ID))return!1;if("login"==V&&redealLogin(),""!=V&&(f||M)&&(u=!0,window.redealJsLoaded.push(V)),s.indexOf("redeal-type=friend")>-1||s.indexOf("voyado-type=friend")>-1){var J=T("redeal-fid",s);if(void 0!==window.redealJsLoaded&&window.redealJsLoaded.length>0&&""!==J&&window.redealJsLoaded.indexOf(J)>=0)return!1;""!==J&&window.redealJsLoaded.push(J)}if((s.indexOf("redeal-type=ambassadortarget")>-1||s.indexOf("voyado-type=ambassadortarget")>-1)&&s.indexOf("redeal-tag")>-1&&(f=!0,V=T("redeal-tag",s),n(e.TAG_DEAL+V)),s.indexOf("eclub")>-1&&s.indexOf("vtid")>-1&&(u=!0),!0===u){const c=window.getBrowserDetails();E=c.deviceType,p=c.os,g=c.browserTypes;var j,H,X="",q="",W="",z="",Y="",$="",Q="",K="",Z="",ee="",te="",re="",ne=navigator.language||navigator.userLanguage;if(""!==e.CPODATA){var oe=R(e.CPODATA),le=""!==oe?JSON.parse(oe):null;if(null!==le){if(null!=le.reset&&1==le.reset){!function(e){for(let t=0;t<localStorage.length;t++){const r=localStorage.key(t);e.includes(r)&&n(r)}for(let t=0;t<sessionStorage.length;t++){const r=sessionStorage.key(t);e.includes(r)&&a(r)}}(["redeal-ambmin","redeal-amb-finish","redeal-mc-all","redeal-amb-finish"])}te=null===le.country?null:le.country,ne=null===le.locale?null:le.locale,X=null===le.email?null:le.email,K=null===le.currency?null:G(le.currency),Z=null===le.phone?null:le.phone,ee=null===le.ssn?null:le.ssn,Y=G(le.total),$=G(le.revenue),""!=(re=G(le.contactId))&&null!=re&&null!=re&&r(e.VOYADOCONTACTID,re),null===le.coupons||Array.isArray(le.coupons)?null!==le.coupons&&Array.isArray(le.coupons)&&le.coupons.length>0&&void 0!==le.coupons[0]&&null!==le.coupons[0]&&(Q=G(le.coupons[0])):Q=G(le.coupons)}}if(t(e.LFVD))if(null!=(H=""!==(j=R(t(e.LFVD)))?JSON.parse(j):null)&&""!==H){const t=H.to.split("-");new Date(parseInt(t[0],10),parseInt(t[1],10)-1,parseInt(t[2],10))>=new Date&&(z=H.deal+","+H.flow),""!=V&&"checkout"!=V||n(e.LFVD)}if(o("redeal-f-dealid")||t(e.AMB_CV)||t(e.FRI_CV))if(null!=(H=""!==(j=R(t(e.AMB_CV)))?JSON.parse(j):null)&&""!==H){const t=H.to.split("-");new Date(parseInt(t[0],10),parseInt(t[1],10)-1,parseInt(t[2],10))>=new Date&&(q=H.deal+","+H.flow+","+H.email),""!=V&&"checkout"!=V||n(e.AMB_CV)}else if(null!=(H=""!==(j=R(t(e.FRI_CV)))?JSON.parse(j):null)&&""!==H){const t=H.to.split("-"),r=new Date(parseInt(t[0],10),parseInt(t[1],10)-1,parseInt(t[2],10));l(e.FRI_CONV_DEAL,H.deal),r>=new Date&&(W=H.deal+","+H.flow+","+H.email),""!=V&&"checkout"!=V||n(e.FRI_CV)}IS_DEBUG&&console.log("redeal('"+V+"',"+R(e.CPODATA)+")");var ae=DEFAULT_APIPATH+"/api/check",ie=(new Date).getTime()-I,de=t(e.PAGESHARE),se=T("redeal-dealid",s);null==se&&(se=T("campaignId",s));var ce=t("redeal-pid"),ue=T("redeal-fid",s),fe=!1;if(ce===ue){if((s.indexOf("?redeal_t=target")>=0||s.indexOf("&redeal_t=target")>=0||s.indexOf("?t=target")>=0||s.indexOf("&t=target")>=0||s.indexOf("?voyado-type=ambassadortarget")>=0||s.indexOf("&voyado-type=ambassadortarget")>=0||s.indexOf("?redeal-type=ambassadortarget")>=0||s.indexOf("&redeal-type=ambassadortarget")>=0)&&(fe=!0),""!==se&&!1===fe)(null!=de&&""!==de&&null!==de.split("-")&&void 0!==de.split("-")&&""!==de.split("-")?de.split("-")[1]:"")===se&&(de="true")}else n(e.PAGESHARE);var Ee=!1;"true"!==de&&(de="false"),""!==de&&(Ee="false"!=de.toLowerCase()),o(e.SELECTED_DOMAIN)&&s.indexOf(o(e.SELECTED_DOMAIN))<=0&&(a(e.SELECTED_SITE),n(e.TAG_DEAL+V),a(e.SELECTED_DOMAIN)),o(e.SELECTED_PARAM)&&s.indexOf(o(e.SELECTED_PARAM))<=0&&(a(e.SELECTED_SITE),n(e.TAG_DEAL+V),a(e.SELECTED_PARAM));let u=t(e.FRIEND_CONV_ID);var pe=JSON.stringify({currency:K,email:X,ambcv:q,frndcv:W,lfvd:z,revenue:$,total:Y,couponcode:Q,sessionid:w,url:s.toLowerCase(),code:V,browserId:A,devicetype:E,resolution:O,os:p,language:"",browsertype:g,agent:navigator.userAgent,delay:ie,pgshr:Ee,rd:IS_DEBUG,ld:t(e.TAG_DEAL+V),ts:(new Date).toLocaleDateString(),ndt:o(e.NEXT_DEALTRIGGER),ndtflow:o(e.NEXT_DEALTRIGGERFLOW),sb:o("redeal-amb-block"),st:R(o(e.SELECTED_SITE)),cdt:o(e.AMB_FINISH),idntuser:t(e.IDENTIFIED),lgin:t(e.HASLOGGEDIN),phone:Z,ssn:ee,lvd:t(e.LAST_VISITDEAL),cfids:u,audience:t(e.AMB_AUDIENCE),subscribe:t(e.AMB_SUBSCRIBE),landref:o(e.INITITALSESSIONURL),scriptver:e.SCRIPTVERSION,locale:ne,country:te,cid:re,eclub:T("eclub",window.location.href)});!(fe||(s.indexOf("redeal-type=")<0||s.indexOf("voyado-type=")<0)&&"checkout"==V.toLowerCase())||""===z&&""===Q&&""===q&&""===W&&""===u||(!function(e){var t=!1;IS_DEBUG&&(t=!0);var r=new XMLHttpRequest;r.open("POST",DEFAULT_APIPATH+d,!0),r.setRequestHeader("Content-Type","application/json"),r.onreadystatechange=function(){try{if(4===this.readyState&&200===this.status){var e=JSON.parse(r.responseText);1==t&&null!=e&&null!=e.wf&&null!=e.wf&&console.log("Conversion "+e.wf.map((e=>e.FlowStep)).join(","),e.wf)}}catch(e){P("Error from CallConversion",e,"check","string",IS_DEBUG)}},r.send(e)}(pe),""!==W&&n(e.FRI_CV));var ge=new XMLHttpRequest;document.querySelectorAll('script[src$="redeal.js"]').length>1?ge.open("POST",ae,!1):ge.open("POST",ae,!0),ge.setRequestHeader("Content-Type","application/json"),ge.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var d=JSON.parse(ge.responseText);try{if(void 0!==o(e.NEXT_DEALTRIGGER)&&""!==o(e.NEXT_DEALTRIGGER)&&"1"==o(e.NEXT_DEALTRIGGER)&&(a(e.NEXT_DEALTRIGGER),a(e.NEXT_DEALTRIGGERFLOW),se=null,f=!0),""!=d.contactid&&null!=d.contactid&&d.contactid.length>4&&r(e.VOYADOCONTACTID,d.contactid),""!==d&&null!=d.wf&&null!=d.wf&&console.log("Check "+d.wf.map((e=>e.FlowStep)).join(","),d.wf),""!==d&&null!=d.ci&&null!=d.ci&&console.log("Check "+d.ci),""!==d&&""!==d.cid&&void 0!==d.cid&&null!==d.cid){var c=d.pid,u=d.dt,S=d.cid.split("@");let C=d.checkkey;var v=null,m=T("redeal-userid",s);null==m&&(m=T("userId",s));var h=T("redeal-channel",s);null==h&&(h=T("channel",s)),null!=d.cid&&null!=d.email&&""!=d.email&&null!=d.email&&(X=d.email);var L=h,y=["3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21"];if(y.includes(h)||null===m&&("1"===h||"2"===h)&&!fe)r("redeal-rc",h);else{var R=t("redeal-rc");(null!==R&&y.includes(R)||null===m&&("1"===R||"2"===R))&&(n("redeal-rc"),L="")}if(S.length>0)if(C)v=function(e){let r=e.cid.split("@"),n=[];for(var l=0;l<r.length;l++)if(r[l]){let e=r[l].split("-["),a=e[1];if(""!==a&&void 0!==a){let r=a.replace("[","").replace("]","").split(",");if(r.length>0){let l=r[0],a=r[1],i=r[2],d=""!==r[3]?r[3].toLowerCase():"";if(""!==l&&"cookie"!==l){let r=t(a);null!=r&&null!==r&&""!=r||(r=o(a)),null!=r&&""!==r?("true"==d&&r===i||"false"==d&&r!==i)&&n.push(e[0]):"false"==d&&n.push(e[0])}else if(""!==l&&"cookie"==l){let t=B(a);null!=t&&""!==t?("true"==d&&-1!==t.indexOf(i)||"false"==d&&t!==i)&&n.push(e[0]):"false"==d&&n.push(e[0])}else""==l&&""==a&&""==i&&n.push(e[0])}}}return n.length>0?function(e){const t=Math.floor(Math.random()*e.length),r=e[t];return r}(n):"nodeal"}(d);else for(var N=0;N<S.length;N++){if(S[N])v=S[N].split("-")[0]}if(""!==o(e.FRI_CONV_DEAL)&&void 0!==o(e.FRI_CONV_DEAL)&&null!==o(e.FRI_CONV_DEAL)&&o(e.FRI_CONV_DEAL)===v)return!1;if("nodeal"==v)return!1;if(null!=d.sc&&null!=d.sc&&""!=d.sc&&d.sc.indexOf(",")>0){let t=d.sc.split(",")[0];""!==t&&null!==t&&l(e.SELECTED_SITE,_(t))}if(null!=d.sd&&null!=d.sd&&""!=d.sd&&l(e.SELECTED_DOMAIN,d.sd.toLowerCase()),null!=d.sp&&null!=d.sp&&""!=d.sp&&l(e.SELECTED_PARAM,d.sp.toLowerCase()),null!=d.ops&&null!=d.ops&&""!=d.ops)if(1==d.ops){if(null!==o(e.TRIGGERONCEPERSESSION)&&""!==o(e.TRIGGERONCEPERSESSION)&&void 0!==o(e.TRIGGERONCEPERSESSION)&&o(e.TRIGGERONCEPERSESSION)==v)return;l(e.TRIGGERONCEPERSESSION,v)}else a(e.TRIGGERONCEPERSESSION);var x=document.createElement("script");x.type="application/javascript",x.src=DEFAULT_FILEPATH+"/widget/js/redeal.min.js",x.id="redeal-min-js",x.setAttribute("redeal-st",I),x.setAttribute("redeal-storels",d.store),x.setAttribute("redeal-dt",u),x.setAttribute("redeal-pid",c),x.setAttribute("redeal-sessionid",w),x.setAttribute("redeal-id",A),x.setAttribute("redeal_code",V),x.setAttribute("redeal-agnt",navigator.userAgent),x.setAttribute("redeal-rc",L),x.setAttribute("redeal-scriptver",e.SCRIPTVERSION),null!==X&&""!==X&&void 0!==X&&X.length>4&&(x.setAttribute("redeal-email",X),b=!0,RedealSetIdentified()),null!==Z&&""!==Z&&void 0!==Z&&Z.length>4&&x.setAttribute("redeal-phone",Z),null!==ee&&""!==ee&&void 0!==ee&&ee.length>4&&x.setAttribute("redeal-ssn",ee),null!==v&&null===se?(f&&(x.setAttribute("redeal-type","checkout"),function(t,r,n,o){var l=!1;IS_DEBUG&&(l=!0);var a=new XMLHttpRequest;a.open("POST",DEFAULT_APIPATH+i,!0);var d=JSON.stringify({rd:l,dealid:t,code:r,sessionid:n,dt:E,ds:O,dos:p,dl:"",bt:g,agent:navigator.userAgent,usertype:"av",popupid:o,url:s,browserid:A,scriptversion:e.SCRIPTVERSION});a.setRequestHeader("Content-Type","application/json"),a.onreadystatechange=function(){try{if(4===this.readyState&&200===this.status){var e=JSON.parse(a.responseText);1==l&&null!=e&&null!=e.wf&&null!=e.wf&&console.log("WidgetFlowEvent "+e.wf.map((e=>e.FlowStep)).join(","),e.wf)}}catch(e){P("Error from WidgetFlowEvent",e,"check","string",IS_DEBUG)}},a.send(d)}(v,V,w,c)),x.setAttribute("redeal-cid",v),l(e.DEAL_ID,v)):null!==se&&(x.setAttribute("redeal-cid",se),l(e.DEAL_ID,se),D&&f&&x.setAttribute("redeal-type","checkout")),n("redeal-pid"),r("redeal-pid",c),document.body.appendChild(x),f&&window.parent.postMessage({voyado:{role:"Ambassador",flowstep:"AmbassadorVisit"}},"*")}}catch(e){P(C,e.stack,"check","processapiresponse",IS_DEBUG)}}},ge.onerror=function(e,t,r){if(null!=e&&!e instanceof ProgressEvent){var n="msg="+encodeURIComponent(e)+"&url="+encodeURIComponent(t)+"&line="+r;P("Error from sending on Check API Request:"+pe+"<br/> Error "+n,null,"check","apiresponse",IS_DEBUG)}},ge.send(pe)}}catch(e){try{console.log("Error during check deal from Redeal API. Error "+e.stack)}catch(e){console.log("Error during to sending error data to Redeal API. Error "+e.stack)}}}finally{window.RedealInProgress=void 0}},"complete"===document.readyState||"interactive"===document.readyState?L()&&redealInit():document.addEventListener&&document.addEventListener("DOMContentLoaded",(function(){L()&&redealInit()}),!1),window.redealAction=e=>{IS_DEBUG&&console.log("redealaction",e),redealInit(void 0!==e?e:"action")},window.redealInstant=t=>{null!==t&&"undefined"!==t&&void 0!==t&&(e.CPODATA=_(JSON.stringify(t))),redealInit("instant")},window.addEventListener("message",(function(e){if(null!=e.data&&null!=e.data.redeal_event_id){let t=e.data.redeal_event_id;if("opendealexistmember"===t){let t=e.data.data.tag;redealInit(t)}else"redeal_identified"===t&&(b=!0,RedealSetIdentified())}}));var x=location.href;function G(e){if(null==e||"null"===e)return"0";try{return"number"==typeof e?e.toString():"string"==typeof e?(e.includes(",")&&e.indexOf(",")>-1&&(e=e.replace(",",".")),e):Number(e).toString()}catch(t){return P("Convert from number to string "+e,t,"check","string",IS_DEBUG),"'"+e+"'"}}function B(e){let t=e+"=",r=document.cookie.split(";");for(let e=0;e<r.length;e++){let n=r[e];for(;" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return""}function P(e,t,r,n,o){o&&console.log("Apiname:"+r+" Message:"+e+" Error:"+t);var l=DEFAULT_APIPATH+"/api/redealerror",a=new XMLHttpRequest;a.open("POST",l,!0),a.setRequestHeader("Content-Type","application/json");var i=JSON.stringify({api:r,browser:g,version:p,screensize:O,url:null!=s&&void 0!==s?s.toLowerCase():"",target:null!=obj&&void 0!==obj?obj.toLowerCase():"",error:e,errortype:n,stacktrace:t});a.send(i)}new MutationObserver((()=>{const e=location.href;e!==x&&(x=e,function(){try{s=location.href}catch(e){s=window.location.href.toLowerCase()}}())})).observe(document,{subtree:!0,childList:!0})})();